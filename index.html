<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sacred Sundays</title>
<meta name="color-scheme" content="light dark" />

<link rel="stylesheet" href="styles.css?v=2025-09-11a" />

<style>
  :root{
    --index-max: 1100px;
    --accent: #2563eb;
  }

  /* Banner */
  header.banner-header{
    background-image: url("Images/teams/sacred-sundays-banner.png");
    background-size: cover; background-position: center; background-repeat: no-repeat;
    position: relative !important; display: block !important; padding: 0 !important; border: 0 !important; box-shadow: none !important;
    height: 200px; width: 100%; overflow: hidden;
  }
  @media (min-width: 900px){ header.banner-header{ min-height: 260px; } }

  /* Hero */
  .hero{ background: linear-gradient(180deg, rgba(15,23,42,.02), rgba(15,23,42,0)); }
  .hero-inner{ max-width: var(--index-max); margin: 0 auto; padding: 18px 12px 8px; color: var(--text); }
  .hero-top{ display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; margin-bottom:6px; }
  .tag{ display:inline-block; background: rgba(37,99,235,.12); color:#1e40af; padding:6px 10px; border-radius:9999px; font-weight:800; letter-spacing:.2px; }
  .pill{
    display:inline-flex; align-items:center; gap:8px; border:2px dashed rgba(0,0,0,.25); color:var(--text); background:transparent;
    padding:8px 14px; border-radius:9999px; height:30px; font-weight:800; cursor:pointer; user-select:none; text-decoration:none;
    transition: background .15s, border-color .15s, transform .1s;
  }
  .pill:hover{ background: rgba(0,0,0,.05) }
  .pill .ico{ font-size:18px; line-height:1 }
  :root.dark .pill{ border-color: rgba(255,255,255,.55); color:#fff; }
  :root.dark .pill:hover{ background: rgba(255,255,255,.12) }

  .hero h2{ margin:8px 0 6px; font-size:28px; line-height:1.2 }
  .hero p{ margin:0; color: var(--muted) }

  /* Cards grid */
  .wrap{ max-width: var(--index-max); margin:16px auto 24px; padding:0 12px; }
  .cards{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:16px; }
  @media (max-width:980px){ .cards{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
  @media (max-width:640px){ .cards{ grid-template-columns: 1fr; } }

  .card{
    background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 16px;
    display:flex; flex-direction:column; gap:14px; box-shadow: 0 6px 20px rgba(0,0,0,.06); transition: transform .12s, box-shadow .12s;
  }
  .card:hover{ transform: translateY(-2px); box-shadow: 0 10px 24px rgba(0,0,0,.08); }
  .card .row{ display:flex; align-items:center; gap:12px; }
  .card .icon{ width:44px; height:44px; display:inline-grid; place-items:center; border-radius:12px; color:#fff; font-size:22px; }
  .card h3{ margin:0; font-size:18px; }
  .card p{ margin:0; color: var(--muted); }
  .card .actions{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }

  .btn{
    display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:10px; text-decoration:none; font-weight:800;
    color:#fff; background: var(--accent); transition: background .12s, transform .1s;
  }
  .btn:hover{ background:#1d4ed8; }
  .btn:active{ transform: scale(.98); }

 /* Two-line ‚ÄúStats Updated‚Äù block */
.updated{
  display:flex; flex-direction:column; align-items:flex-start;
  margin-left:auto; line-height:1.3; white-space:nowrap;
  color: var(--muted);
}
.updated .label{ font-size:11px; text-transform:uppercase; font-weight:800; opacity:.85; }

/* Use variables so you can theme easily */
:root{
  --updated-val: #cc0000;        /* light mode value color */
  --updated-val-dark: #ffb4b4;   /* dark mode value color (change as you like) */
}
.updated .val{
  font-size:12px; font-weight:800;
  color: var(--updated-val);
}
/* Dark mode override */
:root.dark .updated .val,
body.dark .updated .val{
  color: var(--updated-val-dark);
}


  /* Footer */
  footer#site-footer{
    max-width: var(--index-max); margin: 24px auto 40px; padding: 0 12px; color: var(--muted);
    display:flex; justify-content:space-between; align-items:center; gap:12px;
  }
  .views{ display:flex; align-items:center; gap:8px; }
  .views .bubble{ background: var(--card); border:1px solid var(--border); padding:6px 10px; border-radius:9999px; font-weight:800; color: var(--text); }
</style>
</head>
<body>
  <header class="banner-header"></header>

  <section class="hero">
    <div class="hero-inner">
      <div class="hero-top">
        <span class="tag">WELCOME TO THE HQ</span>
        <button id="themeBtn" class="pill" type="button" aria-pressed="false" aria-label="Toggle color theme">
          <span class="ico">üåô</span><span id="themeLbl">Dark Mode</span>
        </button>
      </div>
      <h2></h2>
      <p>Your home for league standings, weekly winners, payouts, and more. Dive in below.</p>
    </div>
  </section>

  <main class="wrap">
    <div class="cards">
      <!-- Standings -->
      <article class="card">
        <div class="row">
          <div class="icon" style="background:#6b7280">üèÜ</div>
          <div>
            <h3>Standings</h3>
            <p>Live table with filters, sorting, CSV, and dark mode.</p>
          </div>
        </div>
        <div class="actions">
          <a href="standings.html" class="btn">Launch</a>
          <span class="updated" id="upd-standings">
            <span class="label">Last Update:</span>
            <span class="val">‚Äî</span>
          </span>
        </div>
      </article>

      <!-- Weekly Winners -->
      <article class="card">
        <div class="row">
          <div class="icon" style="background:#22c55e">ü•á</div>
          <div>
            <h3>Weekly Winners</h3>
            <p>Team/Player high scores with award chips & mobile cards.</p>
          </div>
        </div>
        <div class="actions">
          <a href="weekly-winners.html" class="btn">Launch</a>
          <span class="updated" id="upd-weekly-winners">
            <span class="label">Last Update:</span>
            <span class="val">‚Äî</span>
          </span>
        </div>
      </article>

      <!-- Payouts -->
      <article class="card">
        <div class="row">
          <div class="icon" style="background:#e69138">üí∏</div>
          <div>
            <h3>Prize Pool & Payouts</h3>
            <p>Available prize pool & season long earnings.</p>
          </div>
        </div>
        <div class="actions">
          <a href="payouts.html" class="btn">Launch</a>
          <span class="updated" id="upd-payouts">
            <span class="label">Last Update:</span>
            <span class="val">‚Äî</span>
          </span>
        </div>
      </article>

      <!-- Finances -->
      <article class="card">
        <div class="row">
          <div class="icon" style="background:#efefef">üí≤</div>
          <div>
            <h3>Finances</h3>
            <p>League dues & final payout status.</p>
          </div>
        </div>
        <div class="actions">
          <a href="finances.html" class="btn">Launch</a>
          <span class="updated" id="upd-finances">
            <span class="label">Last Update:</span>
            <span class="val">‚Äî</span>
          </span>
        </div>
      </article>

      <!-- Team Owner & Name History -->
      <article class="card">
        <div class="row">
          <div class="icon" style="background:#3b82f6">üßë‚Äçü§ù‚Äçüßë</div>
          <div>
            <h3>Team Owner & Name History</h3>
            <p>Lifetime history of team owners and team names.</p>
          </div>
        </div>
        <div class="actions">
          <a href="#" class="btn" onclick="alert('Coming soon!');return false;">Coming Soon</a>
          <span class="updated" id="upd-owner-team-history">
            <span class="label">Last Update:</span>
            <span class="val">‚Äî</span>
          </span>
        </div>
      </article>

      <!-- Lifetime Record -->
      <article class="card">
        <div class="row">
          <div class="icon" style="background:#8b5cf6">üìà</div>
          <div>
            <h3>Lifetime Record</h3>
            <p>Years active, games played, playoff appearances, and more.</p>
          </div>
        </div>
        <div class="actions">
          <a href="#" class="btn" onclick="alert('Coming soon!');return false;">Coming Soon</a>
          <span class="updated" id="upd-lifetime-record">
            <span class="label">Last Update:</span>
            <span class="val">‚Äî</span>
          </span>
        </div>
      </article>

      <!-- Suggestions -->
      <article class="card">
        <div class="row">
          <div class="icon" style="background:#356854">üí°</div>
          <div>
            <h3>Suggestions</h3>
            <p>Found a break/fix? Got a suggestion? Fill out the form and I'll get on it.</p>
          </div>
        </div>
       <div class="actions">
  <a href="https://forms.gle/8cbt687kHPq8Yjiu7" 
     target="_blank" 
     rel="noopener noreferrer" 
     class="btn">Submit Idea</a>
</div>

      </article>
    </div>
  </main>

  <footer id="site-footer">
    <div class="views">
      <span>Views:</span>
      <span class="bubble" id="viewCount">‚Äî</span>
    </div>
    <div>&copy; <span id="yr"></span> Sacred Sundays</div>
  </footer>

  <script>
    /* ========== Theme toggle ========== */
    function updateThemeBtn(){
      const dark = document.body.classList.contains("dark");
      document.documentElement.classList.toggle("dark", dark);
      const btn = document.getElementById("themeBtn");
      if(btn) btn.setAttribute("aria-pressed", dark ? "true" : "false");
      const lbl = document.getElementById("themeLbl");
      if(lbl) lbl.textContent = dark ? "Light Mode" : "Dark Mode";
      const ico = document.querySelector("#themeBtn .ico");
      if(ico) ico.textContent = dark ? "‚òÄÔ∏è" : "üåô";
    }
    (function initTheme(){
      const saved = localStorage.getItem("ss_theme");
      if(saved === "dark") document.body.classList.add("dark");
      updateThemeBtn();
    })();
    document.getElementById("themeBtn").addEventListener("click", ()=>{
      const next = !document.body.classList.contains("dark");
      document.body.classList.toggle("dark", next);
      localStorage.setItem("ss_theme", next ? "dark" : "light");
      updateThemeBtn();
    });

    // Footer year
    document.getElementById('yr').textContent = new Date().getFullYear();

    // View counter
    const COUNTER_ENDPOINT = 'https://api.countapi.xyz/hit/sacred-sundays/starquest89-index';
    const elCount = document.getElementById('viewCount');
    async function bumpCounter(){
      try{
        const res = await fetch(COUNTER_ENDPOINT, {cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        const data = await res.json();
        elCount.textContent = data.value?.toLocaleString?.() ?? data.value ?? '‚Äî';
        localStorage.setItem('ss_index_views', data.value);
      }catch(e){
        const n = Number(localStorage.getItem('ss_index_views')||0) + 1;
        localStorage.setItem('ss_index_views', n);
        elCount.textContent = n.toLocaleString();
      }
    }
    bumpCounter();

    /* ========== Stats Updated timestamps ========== */
    // Sheet: gid=2112652019 (sheet name "Standings"), cells A34:B39 contain key -> datetime
    const GSHEET = {
      apiKey: 'AIzaSyDqIFrO42J4b0faekmmEGTjKmbZ4PRGc6M',
      sheetId: '1vNjLCTxmM1c09aONXyQYpGTPwcGG-hmnflq8-ZC3Rmo',
      rangeA1: 'Standings!A31:B39',   // uses the sheet tied to gid=2112652019
      gid: '2112652019'
    };

    // Normalize keys from Column A to robustly match
    const norm = s => (s||'')
      .toString()
      .trim()
      .toLowerCase()
      .replace(/[\s_]+/g,'-')       // spaces/underscores -> hyphens
      .replace(/[^a-z0-9-]/g,'');   // strip punctuation

    // Normalized key -> element id
    const KEY_TO_ELID = {
      'standings': 'upd-standings',
      'weekly-winners': 'upd-weekly-winners',
      'payouts': 'upd-payouts',
      'finances': 'upd-finances',
      'owner-team-history': 'upd-owner-team-history',
      'lifetime-record': 'upd-lifetime-record'
    };

    function setUpdateText(rawKey, text){
      const k = norm(rawKey);
      const id = KEY_TO_ELID[k];
      if(!id){
        console.warn('[StatsUpdated] No element mapping for key:', rawKey, '->', k);
        return;
      }
      const host = document.getElementById(id);
      if(!host){
        console.warn('[StatsUpdated] Element not found for id:', id, '(key:', rawKey, ')');
        return;
      }
      const valEl = host.querySelector('.val');
      if(valEl){
        valEl.textContent = (text && String(text).trim()) || '‚Äî';
      }else{
        // Fallback (shouldn't happen with provided markup)
        host.textContent = 'Stats Updated\n' + ((text && String(text).trim()) || '‚Äî');
      }
    }

    function apiUrl(){
      return `https://sheets.googleapis.com/v4/spreadsheets/${GSHEET.sheetId}/values/${encodeURIComponent(GSHEET.rangeA1)}?key=${GSHEET.apiKey}&majorDimension=ROWS`;
    }
    function csvUrl(){
      return `https://docs.google.com/spreadsheets/d/${GSHEET.sheetId}/export?format=csv&gid=${GSHEET.gid}`;
    }

    // Tiny CSV parser for fallback
    function parseCSV(text){
      const rows=[]; let cur='', row=[], inQ=false;
      for(let i=0;i<text.length;i++){
        const ch=text[i], nx=text[i+1];
        if(inQ){
          if(ch=='"' && nx=='"'){cur+='"';i++;}
          else if(ch=='"'){inQ=false;}
          else cur+=ch;
        }else{
          if(ch=='"') inQ=true;
          else if(ch==','){row.push(cur);cur='';}
          else if(ch=='\n'){row.push(cur);rows.push(row);row=[];cur='';}
          else if(ch!='\r'){cur+=ch;}
        }
      }
      row.push(cur); rows.push(row); return rows;
    }

    async function loadUpdateTimestamps(){
      let filled = 0;

      // Try Google Sheets Values API
      try{
        const r = await fetch(apiUrl(), {cache:'no-store'});
        if(!r.ok) throw new Error('HTTP '+r.status);
        const j = await r.json();
        const values = j.values || [];
        values.forEach(([key, dt]) => {
          if(key){ setUpdateText(key, dt); filled++; }
        });
        if(filled > 0) return; // success
        console.warn('[StatsUpdated] Values API returned no usable rows; falling back to CSV‚Ä¶');
      }catch(e){
        console.warn('[StatsUpdated] Values API failed; falling back to CSV:', e);
      }

      // CSV fallback (rows 34..39 -> zero-based 33..38)
      try{
        const r = await fetch(csvUrl()+`&_=${Date.now()}`, {cache:'no-store'});
        if(!r.ok) throw new Error('CSV HTTP '+r.status);
        const text = await r.text();
        const rows = parseCSV(text);
        for(let i=30;i<=35;i++){
          const key = (rows[i]?.[0]||'').trim();
          const dt  = (rows[i]?.[1]||'').trim();
          if(key){ setUpdateText(key, dt); filled++; }
        }
        if(filled === 0){
          console.warn('[StatsUpdated] CSV fallback had no matching keys in A34:B39.');
        }
      }catch(e){
        console.error('[StatsUpdated] CSV fallback failed:', e);
      }
    }
    loadUpdateTimestamps();
  </script>
</body>
</html>


