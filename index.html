<script>
    const sheetUrls = [
        'https://docs.google.com/spreadsheets/d/1I8LisCM8yshVR6INdMXQ1Qi2wzcYB8x8KI4W0dNK_ME/gviz/tq?tqx=out:csv&gid=2112652019',
        'https://docs.google.com/spreadsheets/d/1I8LisCM8yshVR6INdMXQ1Qi2wzcYB8x8KI4W0dNK_ME/gviz/tq?tqx=out:csv&gid=1442667563',
        'https://docs.google.com/spreadsheets/d/1I8LisCM8yshVR6INdMXQ1Qi2wzcYB8x8KI4W0dNK_ME/gviz/tq?tqx=out:csv&gid=359638493'
    ];

    function cleanData(data) {
        return data.replace(/(^"|"$)/g, '').replace(/""/g, '"');
    }

    function parseCSV(csv) {
        const rows = csv.split('\n');
        return rows.map(row => {
            return row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(cell => cleanData(cell));
        });
    }

    async function fetchData(url, sheetIndex) {
        const response = await fetch(url);
        const data = await response.text();
        let rows = parseCSV(data);

        // Handling specific sheet actions
        if (sheetIndex === 1) { // Assuming sheetIndex 1 is the second sheet
            rows = rows.map(row => row.slice(0, 15)); // Keep only the first 14 columns
        }

        const sheetContainer = document.createElement('div');
        const table = document.createElement('table');
        const tableHead = document.createElement('thead');
        const tableBody = document.createElement('tbody');
        const tableHeaderRow = document.createElement('tr');

        // Add headers
        rows[0].forEach(header => {
            const th = document.createElement('th');
            th.textContent = header;
            tableHeaderRow.appendChild(th);
        });
        tableHead.appendChild(tableHeaderRow);
        table.appendChild(tableHead);

        // Add data rows
        rows.slice(1).forEach((row, rowIndex) => {
            const tr = document.createElement('tr');
            row.forEach((cell, cellIndex) => {
                const td = document.createElement('td');
                td.textContent = cell;
                tr.appendChild(td);
            });
            tableBody.appendChild(tr);
        });
        table.appendChild(tableBody);
        sheetContainer.appendChild(table);

        const container = document.getElementById('sheets-container');
        const title = document.createElement('h2');
        title.textContent = sheetIndex === 0 ? 'SS 2024 Standings' : sheetIndex === 1 ? 'Weekly Winners' : `Sheet ${sheetIndex + 1}`;
        container.appendChild(title);
        container.appendChild(sheetContainer);
    }

    sheetUrls.forEach((url, index) => fetchData(url, index));
</script>
</body>
</html>

